# 常见问题 FAQ

## 知识库相关

### Q：上传的文档 AI 好像没读懂？

检查分段设置。默认分段可能把相关内容切开了。

**解决方案**：尝试调大分段长度，或使用"按段落"分段。

### Q：检索结果不准确？

可能的原因和解决方案：

1. 文档质量问题——格式混乱的 PDF 效果差
2. 尝试高质量索引模式
3. 增加检索数量，用 LLM 筛选

### Q：知识库更新后效果没变？

知识库内容更新后，需要等索引重建完成。

可以在知识库详情页查看索引状态。

## Workflow 相关

### Q：Workflow 运行很慢？

优化建议：

1. 减少不必要的 LLM 调用
2. 能并行的节点并行执行
3. 用更快的模型（gpt-4o-mini）
4. 优化提示词，减少输出长度

### Q：迭代节点报错？

检查输入是不是真的数组。

常见错误：输入的是字符串，不是数组。

### Q：条件分支不生效？

排查步骤：

1. 检查条件变量是否正确
2. 检查比较逻辑（"包含" vs "等于"）
3. 在节点上点"测试"验证

## API 相关

### Q：API 调用返回 401？

API Key 错误或过期。重新生成一个。

### Q：API 调用返回 500？

排查步骤：

1. 检查请求格式是否正确
2. 查看 Dify 后台日志
3. 确认应用已发布

### Q：API 响应很慢？

可能原因：

1. Workflow 本身就慢，优化 Workflow
2. 考虑用异步调用方式
3. 检查网络延迟

## 实际踩过的坑

### 1. 提示词里用了中文引号

Dify 的变量引用要用英文双大括号 `{{}}`

中文的 `""` 会导致变量不生效

### 2. 忘记发布就调 API

修改 Workflow 后要点「发布」，否则 API 调用的还是旧版本

### 3. 知识库权限没分开

给公开应用关联了内部知识库，差点泄露信息

**教训**：不同安全级别的应用，用不同的知识库

### 4. 没有备份就大改

改坏了 Workflow 不知道怎么改回去

**教训**：大改之前先导出 DSL

### 5. 用免费额度做测试被限流

Sandbox 版有调用限制，测试多了就被限了

**教训**：测试用真实环境，别省那点钱
